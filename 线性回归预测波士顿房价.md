# 线性回归预测波士顿房价

**安装模块**

```python
pip install numpy
pip install sklearn
```

**导入模块以及回归模型**

```python
import numpy as np 
from sklearn import datasets
from sklearn.linear_model import LinearRegression
```

**加载波士顿房价数据 波士顿房价有506种房子，506种价格**  

这里的X对应的是房子，y对应的是房价

```python
boston = datasets.load_boston()  # 加载波士顿房价
X = boston['data']  # 数据
y = boston['target']  # 房价
feature_names = boston['feature_names'] # 具体指标
"""
CRIM:犯罪
NOX：空气污染
TAX：税收
"""
feature_names
```

**可以查看数据的大小  大小都是506**

```python
X.shape
y.shape
```

进行数据的拆分 使用打乱的方式，分为训练数据集和测试数据集，80%为训练数据集，20%为测试数据集，用来进行验证

因为房子和房价各有506种，所以可以进行训练集和测试集的划分，注意：训练集和测试集的shape要一样

```python
# 进行数据的索引分割
index = np.arange(506) # 数据的索引
np.random.shuffle(index)
```

**开始划分训练集和测试集**

```python
train_index = index[:405]
test_index = index[405:]
X_train = X[trian_index]
y_train = y[train_index]
X_test = X[test_index]
y_test = y[test_index]
# 使用display()查看数据
display(X_train, y_train)
display(X_test, y_test)
```

**模型的搭建以及训练**

```python
np.set_printoptions(suppress=True) # 去掉科学计数法
model = LinearRegression(fit_intercept=True) # fit_intercept=True 代表计算截距
model.fit(X_train, y_train) # 训练
"""
建模取了斜率，有大有小，有正有负 
正：正相关，面积，越大，房价越高
负：正好相反 
coef_:斜率，系数 
intercept_:截距 
"""
# 查看斜率和截距
display(model.coef_, model.intercept_)
```

**模型验证**

```python
y_ = model.predict(X_test).round(2)  # 结果保留两位小数
y_[:30]   # 查看前30个数据  和y_test里面的前30个数据进行对比
y_test[:30]
```

**模型的评估**

```python
# 最大值是1,可以小于0
model.score(X_test, y_test)
```

**模型评估的实现**
评分的实现过程
y_true= y_test   真实值
y_predict = model.predict(X_test)  预测值
u  ((y_true - y_pred) ** 2).sum() 
v  ((y_true - y_true.mean()) ** 2).sum().

使用公式进行计算：
$$
R^2=1 - u/v
$$


使用最小二乘法进行计算，导入最小二乘法

训练数据的误差要比测试数据的误差小

```python
from sklearn.metrics import mean_squared_error

# 测试数据 y_true和y_pre
mean_squared_error(y_test, y_)

# 80%训练数据 y_true
mean_squared_error(y_train, model.predict(X_train))
```

